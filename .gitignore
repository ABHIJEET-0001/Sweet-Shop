// ==========================================
// ðŸ“ .gitignore
// ==========================================
node_modules/
.env
uploads/
*.log
.DS_Store
.vscode/
dist/
build/

// ==========================================
// ðŸ³ vercel.json (For Vercel Deployment)
// ==========================================
{
  "version": 2,
  "builds": [
    {
      "src": "server.js",
      "use": "@vercel/node"
    }
  ],
  "routes": [
    {
      "src": "/(.*)",
      "dest": "/server.js"
    }
  ],
  "env": {
    "MONGODB_URI": "@mongodb_uri",
    "JWT_SECRET": "@jwt_secret"
  }
}

// ==========================================
// ðŸŽ¯ POSTMAN Collection JSON
// ==========================================
{
  "info": {
    "name": "Sweet Shop E-commerce API",
    "description": "Complete API collection for Sweet Shop Backend",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "item": [
    {
      "name": "Authentication",
      "item": [
        {
          "name": "Register User",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "url": {
              "raw": "{{base_url}}/auth/register",
              "host": ["{{base_url}}"],
              "path": ["auth", "register"]
            },
            "body": {
              "mode": "raw",
              "raw": "{\n  \"name\": \"John Doe\",\n  \"email\": \"john@example.com\",\n  \"password\": \"password123\",\n  \"phone\": \"9876543210\"\n}"
            }
          }
        },
        {
          "name": "Login User",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "url": {
              "raw": "{{base_url}}/auth/login",
              "host": ["{{base_url}}"],
              "path": ["auth", "login"]
            },
            "body": {
              "mode": "raw",
              "raw": "{\n  \"email\": \"john@example.com\",\n  \"password\": \"password123\"\n}"
            }
          }
        },
        {
          "name": "Get Profile",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}/auth/profile",
              "host": ["{{base_url}}"],
              "path": ["auth", "profile"]
            }
          }
        }
      ]
    },
    {
      "name": "Products",
      "item": [
        {
          "name": "Get All Products",
          "request": {
            "method": "GET",
            "url": {
              "raw": "{{base_url}}/products?page=1&limit=12",
              "host": ["{{base_url}}"],
              "path": ["products"],
              "query": [
                {
                  "key": "page",
                  "value": "1"
                },
                {
                  "key": "limit",
                  "value": "12"
                }
              ]
            }
          }
        },
        {
          "name": "Get Product by ID",
          "request": {
            "method": "GET",
            "url": {
              "raw": "{{base_url}}/products/{{product_id}}",
              "host": ["{{base_url}}"],
              "path": ["products", "{{product_id}}"]
            }
          }
        },
        {
          "name": "Create Product (Admin)",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{admin_token}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}/products",
              "host": ["{{base_url}}"],
              "path": ["products"]
            },
            "body": {
              "mode": "formdata",
              "formdata": [
                {
                  "key": "name",
                  "value": "Gulab Jamun",
                  "type": "text"
                },
                {
                  "key": "description",
                  "value": "Sweet and delicious traditional Indian dessert",
                  "type": "text"
                },
                {
                  "key": "price",
                  "value": "250",
                  "type": "text"
                },
                {
                  "key": "category",
                  "value": "Traditional Sweets",
                  "type": "text"
                },
                {
                  "key": "stock",
                  "value": "100",
                  "type": "text"
                },
                {
                  "key": "images",
                  "type": "file",
                  "src": "/path/to/image.jpg"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "Cart",
      "item": [
        {
          "name": "Get Cart",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}/cart",
              "host": ["{{base_url}}"],
              "path": ["cart"]
            }
          }
        },
        {
          "name": "Add to Cart",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "url": {
              "raw": "{{base_url}}/cart/add",
              "host": ["{{base_url}}"],
              "path": ["cart", "add"]
            },
            "body": {
              "mode": "raw",
              "raw": "{\n  \"productId\": \"{{product_id}}\",\n  \"quantity\": 2\n}"
            }
          }
        }
      ]
    },
    {
      "name": "Orders",
      "item": [
        {
          "name": "Create Order",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "url": {
              "raw": "{{base_url}}/orders",
              "host": ["{{base_url}}"],
              "path": ["orders"]
            },
            "body": {
              "mode": "raw",
              "raw": "{\n  \"shippingAddress\": {\n    \"name\": \"John Doe\",\n    \"phone\": \"9876543210\",\n    \"street\": \"123 Main St\",\n    \"city\": \"Mumbai\",\n    \"state\": \"Maharashtra\",\n    \"zipCode\": \"400001\"\n  },\n  \"paymentMethod\": \"COD\"\n}"
            }
          }
        },
        {
          "name": "Get My Orders",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}/orders",
              "host": ["{{base_url}}"],
              "path": ["orders"]
            }
          }
        }
      ]
    },
    {
      "name": "Admin",
      "item": [
        {
          "name": "Get Dashboard Stats",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{admin_token}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}/admin/dashboard",
              "host": ["{{base_url}}"],
              "path": ["admin", "dashboard"]
            }
          }
        },
        {
          "name": "Get All Orders",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{admin_token}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}/admin/orders?page=1&limit=20",
              "host": ["{{base_url}}"],
              "path": ["admin", "orders"]
            }
          }
        },
        {
          "name": "Update Order Status",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{admin_token}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "url": {
              "raw": "{{base_url}}/admin/orders/{{order_id}}/status",
              "host": ["{{base_url}}"],
              "path": ["admin", "orders", "{{order_id}}", "status"]
            },
            "body": {
              "mode": "raw",
              "raw": "{\n  \"status\": \"Shipped\",\n  \"note\": \"Order shipped via courier\"\n}"
            }
          }
        }
      ]
    }
  ],
  "variable": [
    {
      "key": "base_url",
      "value": "http://localhost:5000/api",
      "type": "string"
    },
    {
      "key": "token",
      "value": "",
      "type": "string"
    },
    {
      "key": "admin_token",
      "value": "",
      "type": "string"
    },
    {
      "key": "product_id",
      "value": "",
      "type": "string"
    },
    {
      "key": "order_id",
      "value": "",
      "type": "string"
    }
  ]
}

// ==========================================
// ðŸ“ Sample Test Data Script
// ==========================================
// Create this file as: seed.js
// Run with: node seed.js

require('dotenv').config();
const mongoose = require('mongoose');
const bcrypt = require('bcryptjs');
const User = require('./models/User');
const Product = require('./models/Product');

const seedDatabase = async () => {
  try {
    await mongoose.connect(process.env.MONGODB_URI);
    console.log('Connected to MongoDB');

    // Clear existing data
    await User.deleteMany({});
    await Product.deleteMany({});
    console.log('Cleared existing data');

    // Create admin user
    const hashedPassword = await bcrypt.hash('admin123', 12);
    const admin = await User.create({
      name: 'Admin',
      email: 'admin@sweetshop.com',
      password: hashedPassword,
      phone: '9999999999',
      role: 'admin',
      address: {
        street: '123 Admin Street',
        city: 'Nasirabad',
        state: 'Rajasthan',
        zipCode: '305601'
      }
    });
    console.log('Admin user created');

    // Create sample products
    const sampleProducts = [
      {
        name: 'Gulab Jamun',
        description: 'Soft and spongy sweet balls soaked in sugar syrup',
        price: 250,
        category: 'Traditional Sweets',
        images: ['/uploads/products/gulab-jamun.jpg'],
        stock: 100,
        weight: '500g',
        isFeatured: true,
        tags: ['traditional', 'popular', 'festival'],
        createdBy: admin._id
      },
      {
        name: 'Rasgulla',
        description: 'Soft cottage cheese balls in light sugar syrup',
        price: 200,
        category: 'Traditional Sweets',
        images: ['/uploads/products/rasgulla.jpg'],
        stock: 80,
        weight: '500g',
        tags: ['traditional', 'light'],
        createdBy: admin._id
      },
      {
        name: 'Dry Fruit Mix',
        description: 'Premium quality mixed dry fruits',
        price: 800,
        category: 'Dry Fruits',
        images: ['/uploads/products/dry-fruits.jpg'],
        stock: 50,
        weight: '1kg',
        isFeatured: true,
        tags: ['healthy', 'premium'],
        createdBy: admin._id
      }
    ];

    await Product.insertMany(sampleProducts);
    console.log('Sample products created');

    console.log('\nâœ… Database seeded successfully!');
    console.log('\nAdmin Credentials:');
    console.log('Email: admin@sweetshop.com');
    console.log('Password: admin123');

    process.exit(0);
  } catch (error) {
    console.error('Seeding error:', error);
    process.exit(1);
  }
};

seedDatabase();